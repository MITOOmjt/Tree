# 树上的鸟 - Tree Bird Game

关键点需要更新：
1. 更新功能列表，添加新的花朵生成和选择UI功能
2. 更新项目结构，确保包含新添加的scene/generator_ui.tscn和相关脚本
3. 整合我之前编写的更详细的路径规则、代码结构规则等专业指南
4. 保持未来开发计划的部分，但更新以反映目前的开发进度

我将保持原始文档的简洁风格，但使其更加全面和专业。</think># 树上的鸟 - Tree Bird Game

一个基于Godot 4.3开发的生成型游戏，玩家可以在游戏世界中生成树木、花朵和鸟类，并管理资源系统。

## 功能

- 使用简单的多边形图形表示树、花朵和鸟
- 动态资源管理系统，使用金币作为游戏内货币
- 点击树的任何位置可以生成一只鸟（消耗10金币）
- 点击空白区域可根据选择生成树木（消耗3金币）或花朵（消耗1金币）
- 每棵树每5秒自动产生1金币
- 实时显示当前选择的生成物类型和金币余额
- 通过生成器UI面板切换生成对象类型

## 如何使用

1. 克隆此仓库
2. 使用Godot 4.3引擎打开项目
3. 运行`scene/main.tscn`场景
4. 使用底部的生成器UI面板选择要生成的对象类型
5. 点击空白区域生成树木或花朵（取决于当前选择）
6. 点击树木生成鸟类（需要足够金币）

## 项目结构

```
tree/
├── treegame/                 # 游戏主要内容目录
│   ├── scene/                # 场景文件目录
│   │   ├── main.tscn         # 主场景
│   │   ├── direct_tree.tscn  # 树木场景
│   │   ├── flower.tscn       # 花朵场景
│   │   ├── bird.tscn         # 鸟类场景
│   │   ├── ui.tscn           # 主UI场景
│   │   └── generator_ui.tscn # 生成器选择UI场景
│   ├── .godot/               # Godot引擎配置文件
│   ├── project.godot         # 项目配置文件
│   └── icon.svg              # 项目图标
├── scripts/                  # 脚本文件目录
│   ├── background_manager.gd # 背景及对象管理器
│   ├── generator_ui.gd       # 生成器UI控制器
│   ├── ui.gd                 # 界面控制脚本
│   ├── direct_tree.gd        # 树木行为脚本
│   ├── bird.gd               # 鸟的逻辑脚本
│   └── global.gd             # 全局单例（金币系统）
├── .git/                     # Git版本控制目录
├── .gitignore                # Git忽略文件配置
└── README.md                 # 项目说明文档
```

## 路径规则与引用规范

- 所有资源引用必须使用`res://`作为根目录，例如：`preload("res://scene/flower.tscn")`
- 避免使用相对路径或绝对路径引用资源
- 场景文件必须放在`scene/`目录中
- 脚本文件必须放在`scripts/`目录中
- 脚本文件名应与其关联的场景文件名保持一致（例如：direct_tree.tscn 对应 direct_tree.gd）

## 代码结构规则

### 命名规范
- **变量名**：使用小写字母和下划线，如`flower_scene`、`current_generator`
- **函数名**：使用小写字母和下划线，如`spawn_flower`、`update_coins_display`
- **信号名**：使用小写字母和下划线，描述事件，如`generator_selected`
- **常量和枚举**：使用驼峰命名法，如`GeneratorType`

### 脚本结构
每个脚本文件应遵循以下结构顺序：
1. 类/节点定义（extends语句）
2. 信号定义（signal关键字）
3. 常量和枚举定义（const和enum关键字）
4. 导出变量（export关键字）
5. 类变量定义
6. 内置函数（_ready、_process等）
7. 自定义函数
8. 信号回调函数（通常以_on开头）

### 注释规则
- 每个脚本文件顶部应该有简短的描述
- 复杂函数应该有函数描述注释
- 使用`#`添加行注释解释逻辑
- 代码中使用4个空格缩进

## UI系统规则
- 所有UI元素应作为CanvasLayer的子节点
- UI控件应该有合适的布局和锚点设置
- 按钮和可交互元素应该有清晰的视觉反馈

## 游戏内容规则

### 资源系统
- 金币作为基本货币单位
- 每种生成物都有固定的成本：
  - 树木：3金币
  - 花朵：1金币
  - 鸟类：10金币（需点击树木生成）

### 对象生成系统
- 点击场景空白处根据当前选择生成对象
- 点击树木可触发鸟类生成（消耗金币）

## Git工作流
- 主分支始终保持可运行状态
- 新功能在单独的功能分支上开发（如flower-feature分支）
- 提交消息应详细描述更改内容
- 合并前解决所有冲突

## 开发规范

与AI助手一起开发时，请参考`AI_ASSISTANT_GUIDELINES.md`文件了解AI的行为规范。

## 调试指南
- 使用`print()`函数输出关键信息用于调试
- 错误信息应该清晰描述问题
- 发布版本前移除或禁用调试输出

## 后续开发计划

- 为鸟添加飞行动画
- 为花朵添加生长动画
- 添加更多互动元素（如昆虫）
- 实现不同对象之间的互动系统
- 添加音效和背景音乐
- 优化UI系统和资源管理
- 添加存档和读档功能

## 性能优化准则
- 避免在_process中执行复杂计算
- 使用对象池化技术管理频繁创建/销毁的对象
- 尽量复用资源而不是重复加载

## 版本管理
- 使用语义化版本规则（主版本.次版本.补丁版本）
- 重大更新记录在CHANGELOG.md中

## 许可证

此项目采用MIT许可证
